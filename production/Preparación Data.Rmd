---
title: "Preparación Data"
author: "Brian Montenegro"
date: "20-01-2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
### TRATAMIENTO DE VARIABLES DE PARTICIPACIÓN POLÍTICA, SEXO Y CANTIDAD DE LIBROS
#Abrir base de datos desde Repositorio Github
est_data <- haven::read_dta(file = url("https://github.com/formacionciudadana/data-paces/blob/main/docs/paces/data/base_estudiantesv2.dta?raw=true"))

#Librerías necesarias para la preparación de datos
pacman::p_load(dplyr, sjmisc, car, sjlabelled, stargazer)
```

```{r, echo=FALSE}
#Creación de data frame con variables a utilizar
est_data<- est_data %>% select(P58, 
                               P68, 
                               P31A, 
                               P31B,   
                               P31C,
                               P33A,
                               P33B,
                               P33C,
                               P33D,
                               P33E,
                               P33F,
                               P33G,
                               P33H)
View(est_data)
```

```{r, echo=FALSE}
#Nombrar variables
est_data <- est_data %>% rename("SEXO" = P58)
est_data <- est_data %>% rename("LIBROS" = P68) 
est_data <- est_data %>% rename("MUNICIPALES" = P31A) #Intención de Voto en Municipales
est_data <- est_data %>% rename("PRESIDENCIALES" = P31B) #Intención de voto en Presidenciales
est_data <- est_data %>% rename("INFORMARSE" = P31C) #Intención de informarse
est_data <- est_data %>% rename("FIRMAR PETICION" = P33A) # Desde A hasta H, actividades realizadas durante los últimos 12 meses
est_data <- est_data %>% rename("MARCHA AUTORIZADA" = P33B)
est_data <- est_data %>% rename("MARCHA NO AUTORIZADA" = P33C)
est_data <- est_data %>% rename("BLOQUEO CALLES" = P33D)
est_data <- est_data %>% rename("PINTAR PAREDES" = P33E)
est_data <- est_data %>% rename("TOMA" = P33F)
est_data <- est_data %>% rename("SERVICIOS COMUNITARIOS" = P33G)
est_data <- est_data %>% rename("REUNION POLITICA" = P33H)
```

```{r, echo=FALSE}
#Etiquetar variables
est_data$SEXO <- set_label(x = est_data$SEXO,label = "Sexo")
est_data$LIBROS <- set_label(x = est_data$LIBROS,label = "Número de libros")
est_data$MUNICIPALES <- set_label(x = est_data$MUNICIPALES ,label = "Intención de voto en Municipales")
est_data$PRESIDENCIALES <- set_label(x = est_data$PRESIDENCIALES ,label = "Intención de voto en Presidenciales")
est_data$INFORMARSE <- set_label(x = est_data$INFORMARSE ,label = "Intención de informarse antes de elecciones")
est_data$`FIRMAR PETICION` <- set_label(x = est_data$`FIRMAR PETICION` ,label = "PARTICIPACION: Firmar una petición")
est_data$`MARCHA AUTORIZADA` <- set_label(x = est_data$`MARCHA AUTORIZADA` ,label = "PARTICIPACION: Marcha autorizada")
est_data$`MARCHA NO AUTORIZADA` <- set_label(x = est_data$`MARCHA NO AUTORIZADA` ,label = "PARTICIPACION: Marcha no autorizada")
est_data$TOMA <- set_label(x = est_data$TOMA ,label = "PARTICIPACION: EN tomas")
est_data$`SERVICIOS COMUNITARIOS` <- set_label(x = est_data$`SERVICIOS COMUNITARIOS` ,label = "PARTICIPACION: Trabajos comunitarios")
est_data$`REUNION POLITICA` <- set_label(x = est_data$`REUNION POLITICA` ,label = "PARTICIPACION: REUNION POLITICA")
```

```{r, echo=FALSE}
#Decretar casos perdidos y eliminar sus antiguas etiquetas
est_data$SEXO <- set_na(est_data$SEXO, na = c(3,4,9), drop.levels = TRUE, as.tag = FALSE)
est_data$LIBROS <- set_na(est_data$LIBROS, na = c(8,9), drop.levels = TRUE, as.tag = FALSE)
est_data$MUNICIPALES <- set_na(est_data$MUNICIPALES, na = c(4,9), drop.levels = TRUE, as.tag = FALSE)
est_data$PRESIDENCIALES <- set_na(est_data$PRESIDENCIALES, na = c(4,9), drop.levels = TRUE, as.tag = FALSE)
est_data$INFORMARSE <- set_na(est_data$INFORMARSE, na = c(4,9), drop.levels = TRUE, as.tag = FALSE)
est_data$`FIRMAR PETICION`<- set_na(est_data$`FIRMAR PETICION`, na = c(3,9), drop.levels = TRUE, as.tag = FALSE)
est_data$`MARCHA AUTORIZADA` <- set_na(est_data$`MARCHA AUTORIZADA`, na = c(3,9), drop.levels = TRUE, as.tag = FALSE)
est_data$`MARCHA NO AUTORIZADA` <- set_na(est_data$`MARCHA NO AUTORIZADA`, na = c(3,9), drop.levels = TRUE, as.tag = FALSE)
est_data$TOMA <- set_na(est_data$TOMA, na = c(3,9), drop.levels = TRUE, as.tag = FALSE)
est_data$`SERVICIOS COMUNITARIOS`<- set_na(est_data$`SERVICIOS COMUNITARIOS`, na = c(3,9), drop.levels = TRUE, as.tag = FALSE)
est_data$`REUNION POLITICA`<- set_na(est_data$`REUNION POLITICA`, na = c(3,9), drop.levels = TRUE, as.tag = FALSE)
```